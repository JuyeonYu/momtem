<h1>마이페이지</h1>

<section>
  <h2>내 정보</h2>
  <p>
    닉네임: <strong><%= @user.display_name %></strong>
  </p>
  <%= form_with url: my_page_path, method: :patch, local: true do |f| %>
    <div>
      <label for="user_nickname">닉네임 변경</label>
      <%= text_field_tag 'user[nickname]', @user.nickname, maxlength: 30 %>
      <%= submit_tag '저장' %>
    </div>
  <% end %>
  <p>
    (실제 이름: <%= @user.name.presence || '-' %>)<br>
    이메일: <%= @user.email.presence || '-' %>
  </p>
</section>

<section>
  <h2>내가 쓴 리뷰</h2>
  <% if @reviews.any? %>
    <ul>
      <% @reviews.each do |review| %>
        <li>
          <%= link_to(review.title.presence || '무제', review_path(review)) %>
          <small>(<%= review.created_at.strftime('%Y-%m-%d %H:%M') %>)</small>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>작성한 리뷰가 없습니다.</p>
  <% end %>
</section>

<section>
  <h2>내가 쓴 국민템</h2>
  <% if @recommand_items.any? %>
    <ul>
      <% @recommand_items.each do |item| %>
        <li>
          <%= link_to(item.title.presence || '무제', recommand_item_path(item)) %>
          <small>(<%= item.created_at.strftime('%Y-%m-%d %H:%M') %>)</small>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>작성한 국민템이 없습니다.</p>
  <% end %>
</section>

<section>
  <h2>내가 쓴 대나무숲 글</h2>
  <% if @bamboos.any? %>
    <ul>
      <% @bamboos.each do |bamboo| %>
        <li>
          <%= link_to(bamboo.title.presence || '무제', bamboo_path(bamboo)) %>
          <small>(<%= bamboo.created_at.strftime('%Y-%m-%d %H:%M') %>)</small>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>작성한 대나무숲 글이 없습니다.</p>
  <% end %>
</section>

<section>
  <h2>내 댓글</h2>
  <% if @comments.any? %>
    <ul>
      <% @comments.each do |comment| %>
        <% parent = comment.commentable %>
        <li>
          <%= truncate(comment.body.to_s, length: 80) %>
          <% if parent %>
            - <%= link_to '원문 보기', polymorphic_path(parent) %>
          <% end %>
          <small>(<%= comment.created_at.strftime('%Y-%m-%d %H:%M') %>)</small>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>작성한 댓글이 없습니다.</p>
  <% end %>
</section>
